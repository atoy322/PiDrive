class UserInterface {
    constructor(canvas) {
        this.canvas = canvas;
        this.context = canvas.getContext("2d");
        canvas.addEventListener("touchmove", this.touchmotion.bind(this));
        canvas.addEventListener("touchstart", this.touchstart.bind(this));
        canvas.addEventListener("touchend", this.touchend.bind(this));

        this.speed_slider = new SliderV(canvas, 30, 50, 10, 400);
    }

    touchmotion(e) {
        e.preventDefault();
        console.log(e.changedTouches);
    }

    touchstart(e) {
        e.preventDefault();
    }

    touchend(e) {
        e.preventDefault();
    }

    render() {
        this.speed_slider.render();
        requestAnimationFrame(this.render.bind(this));
    }
}

class SliderV {
    constructor(canvas, margin_x, margin_y, width, height) {
        this.canvas = canvas;
        this.context = canvas.getContext("2d");
        this.margin_x = margin_x;
        this.margin_y = margin_y;
        this.width = width;
        this.height = height;
    }

    render() {
        var w = this.canvas.width;
        var h = this.canvas.height;

        var left_x = w * (this.margin_x / 100);
        var top_y = h * (this.margin_y / 100);
        console.log(left_x, top_y);
        this.context.beginPath();
        this.context.fillStyle = "rgb(127, 127, 127)"
        this.context.rect(this.left_x, this.top_y, this.width, this.height);
        this.context.fill();
        this.context.closePath();
    }
}

function onload() {
    canvas = document.getElementById("screen");
    ctx = canvas.getContext("2d");
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    console.log(canvas.width, canvas.height);

    var UI = new UserInterface(canvas);
    UI.render();

    window.addEventListener("resize", onrotation);
}

function onrotation() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}

function coordinate(element, x, y) {
    // 全体的な座標 ⇒ element内の座標
    var pos = element.getBoundingClientRect();
    var X = pos.left + window.pageXOffset;
    var Y = pos.top  + window.pageYOffset;
    var xy = new Array(2);
    xy[0] = x-X;
    xy[1] = y-Y;
    return xy;
}